---
layout:     post
title:      推荐系统
subtitle:   
date:       2020-03-05
author:     YY
header-img: img/post-bg-rwd.jpg
catalog: true
tags:
    - 推荐系统
    - 机器学习
---
  

## 推荐系统

#### 协调过滤    
三个假设：相似的用户会喜欢相似的商品；用户之间的相似度可以通过商品来衡量；商品之间的相似度可以通过哪些用户购买过来衡量。     

人以群分（User-Based CF）基本原理：用户间相似度的计算，找到和目标用户最相似的其他用户，找到这些用户喜欢的，并且目标用户未注意到的商品，以此推荐。     

看了又看（Item-Based CF）基本原理：计算物品相似度，根据用户的历史购买情况，生成推荐列表。   

隐因子模型（Latent Factor Model）基本原理：通过机器学习方法从用户-物品评分矩阵中分解为两个低阶矩阵，表示对用户兴趣和物品的隐含分类特征，通过隐含特征预测用户评分。即我们认为每件物品$i$在各个类别$k=1,2,...$上有一个权重的分布$q(i,k)$。用户对物品的偏好，可以由用户和类别以及物品和类别的关系体现   

Embedding+MLP是离散特征进行深度学习CTR预估的通用框架：
1. 通过embedding layer将大规模的稀疏矩阵投影为低维连续的embedding vector
2. 向量concat后输入到一个全连接网络中
3. 不断堆叠全连接层
4. 最终输出预测的点击率    
![image](https://upload-images.jianshu.io/upload_images/1319517-fdddad17d178284a.PNG?imageMogr2/auto-orient/strip|imageView2/2/w/662/format/webp)      

---

##### 要实现协调过滤，需要的步骤？   
1. 手机用户偏好
2. 找到相似的用户或商品
3. 计算推荐   

相似度计算   
1. 欧氏距离
2. 皮尔逊相关系数[-1, +1]：用协方差除以两个变量的标准差得到。（常用）
3. Cosine相似度（余弦距离）
   
邻居的选择    
A.固定数量的邻居    
B.基于相似度门槛的邻居    

基于用户的协调过滤     
- 已知用户评分矩阵Matrix R（一般都是非常稀疏的） ；推荐矩阵中空格empty cells处的值
- 问题issues：对于一个新用户，新用户很难找到邻居；对于一个物品，其没有多少打分
- 基础解决方案：相似度计算最好使用皮尔孙逊相似度；考虑共同打分物品的数目，如乘上min(n,N)，n为共同打分数，N指定阈值；对打分进行归一化处理；设置一个相似度阈值
- 基于用户的协同过滤不流行：1.稀疏问题 2.用户量大，计算量大 3.人是善变的   

基于物品的协调过滤   
- 计算性能高，通常用户数量远大于物品数量；可预先计算保留，物品并不善变
- 用户冷启动问题：引导用户把自己的一些属性表达出来；利用现有的开放数据平台；根据用户注册属性；推荐排行榜单
- 物品冷启动问题：文本分析；主题模型；打标签；推荐排行榜

基于用户的推荐：实时新闻，突发情况   
基于物品的推荐：图书，电子商务，电影   

LFM（latent factor model）隐语义模型的核心思想是通过隐含特征(latent factor)联系用户兴趣和物品，采取基于用户行为统计的自动聚类。隐含语义分析技术允许我们指定最终有多少个分类，这个数字越大，分类的粒度就会越细，反正分类粒度就越粗。   
隐语义模型：从数据出发，进行个性化推荐；用户和物品之间有着隐含的关系‘计算机能更好理解隐含因子；将用户和物品通过中介隐含因子联系起来。   
$Proference(u,i)=r_{ui}=p^T_uqi=\sum_{f=1}^Fp_{u,k}q_{i,k}$，$p_{u,k}$度量了用户u和第k个隐类的关系，$q_{i,k}$度量了第k个隐类和物品i直接的关系。要计算这两个参数，需要一个训练集，对于每个用户 u ，训练集里都包含了用户 u 喜欢的物品和不感兴趣的物品，通过学习这个数据集，就可以获得上面的模型参数。    
推荐系统的用户行为分为显性反馈和隐性反馈。LFM 在显性反馈数据（也就是评分数据）上解决评分预测问题并达到了很好的精度。不过本章主要讨论的是隐性反馈数据集，这种数据集的特点是只有正样本（用户喜欢什么物品），而没有负样本（用户对什么物品不感兴趣）。    
**隐语义模型负样本选择**：对每个用户，要保证正负样本的平衡（数目相似）；选取那些很热门，而用户却没有行为的物品；对于用户-物品集K{(u,i)}，其中如果(u,i)是正样本，则$r_{ui} = 1$，负样本则$r_{ui} = 0$。   
**隐语义模型参数选择**：隐特征的个数F，通常F=100；学习速率alpha别太大；正则化参数lambda别太大；负样本/正样本比率ratio。    
**评价指标**：准确度RMSE，召回率Recall，覆盖率Coverage/熵H，多样性Diversity     

基于矩阵分解（SVD奇异值分解）的推荐：对矩阵进行SVD分解，将得到USV，S矩阵只有对角线有值，值越大指对应的列特征越重要

协调过滤VS隐语义   
- 原理：协同过滤基于统计，隐语义基于建模
- 空间复杂度，隐语义模型较小
- 实时推荐难，目前离线计算多
- 隐语义模型难解释